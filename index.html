<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta charset="utf-8" />
<meta name="generator" content="Docutils 0.22.4: https://docutils.sourceforge.io/" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Database Test 7 (DBT-7) User's Guide</title>
<style type="text/css">

/* Minimal style sheet for the HTML output of Docutils.                    */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: minimal.css 10018 2025-03-06 16:19:15Z milde $                                                               */
/* :Copyright: © 2015, 2021 Günter Milde.                                  */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */

/* This CSS3 stylesheet defines rules for Docutils elements without        */
/* HTML equivalent. It is required to make the document semantics visible. */
/*                                                                         */
/* .. _validates: http://jigsaw.w3.org/css-validator/validator$link        */

/* titles */
p.topic-title,
p.admonition-title,
p.system-message-title {
  font-weight: bold;
}
p.sidebar-title,
p.rubric {
  font-weight: bold;
  font-size: larger;
}
p.rubric {
  color: maroon;
}
p.subtitle,
p.section-subtitle,
p.sidebar-subtitle {
  font-weight: bold;
  margin-top: -0.5em;
}
h1 + p.subtitle {
  font-size: 1.6em;
}
a.toc-backref {
  color: inherit;
  text-decoration: none;
}

/* Warnings, Errors */
.system-messages h2,
.system-message-title,
pre.problematic,
span.problematic {
  color: red;
}

/* Inline Literals */
.docutils.literal {
  font-family: monospace;
  white-space: pre-wrap;
}
/* do not wrap at hyphens and similar: */
.literal > span.pre { white-space: nowrap; }

/* keep line-breaks (\n) visible */
.pre-wrap { white-space: pre-wrap; }

/* Lists */

/* compact and simple lists: no margin between items */
.simple  li, .simple  ul, .simple  ol, .simple  > li p,
.compact li, .compact ul, .compact ol, .compact > li p,
dl.simple  > dd, dl.compact > dd, dl.docinfo > dd {
  margin-top: 0;
  margin-bottom: 0;
}
/* Nested Paragraphs */
p:first-child { margin-top: 0; }
p:last-child { margin-bottom: 0; }
details > p:last-child { margin-bottom: 1em; }

/* Table of Contents */
.contents ul.auto-toc { /* section numbers present */
  list-style-type: none;
}

/* Enumerated Lists */
ol.arabic     { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }

/* Definition Lists and Derivatives */
dt .classifier { font-style: italic }
dt .classifier:before {
  font-style: normal;
  margin: 0.5em;
  content: ":";
}
/* Field Lists and similar */
/* bold field name, content starts on the same line */
dl.field-list,
dl.option-list,
dl.docinfo {
  display: flow-root;
}
dl.field-list > dt,
dl.option-list > dt,
dl.docinfo > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.25em;
}
/* Offset for field content (corresponds to the --field-name-limit option) */
dl.field-list > dd,
dl.option-list > dd,
dl.docinfo > dd {
  margin-left:  9em; /* ca. 14 chars in the test examples, fit all Docinfo fields */
}
/* start nested lists on new line */
dd > dl:first-child,
dd > ul:first-child,
dd > ol:first-child {
  clear: left;
}
/* start field-body on a new line after long field names */
dl.field-list > dd > *:first-child,
dl.option-list > dd > *:first-child
{
  display: inline-block;
  width: 100%;
  margin: 0;
}

/* Bibliographic Fields (docinfo) */
dl.docinfo pre.address {
  font: inherit;
  margin: 0;
}
dl.docinfo > dd.authors > p { margin: 0; }

/* Option Lists */
dl.option-list > dt { font-weight: normal; }
span.option { white-space: nowrap; }

/* Footnotes and Citations  */

.footnote, .citation { margin: 1em 0; } /* default paragraph skip (Firefox) */
/* hanging indent */
.citation { padding-left: 2em; }
.footnote { padding-left: 1.7em; }
.footnote.superscript { padding-left: 1.0em; }
.citation > .label { margin-left: -2em; }
.footnote > .label { margin-left: -1.7em; }
.footnote.superscript > .label { margin-left: -1.0em; }

.footnote > .label + *,
.citation > .label + * {
  display: inline-block;
  margin-top: 0;
  vertical-align: top;
}
.footnote > .backrefs + *,
.citation > .backrefs + * {
  margin-top: 0;
}
.footnote > .label + p, .footnote > .backrefs + p,
.citation > .label + p, .citation > .backrefs + p {
  display: inline;
  vertical-align: inherit;
}

.backrefs { user-select: none; }
.backrefs > a { font-style: italic; }

/* superscript footnotes */
a[role="doc-noteref"].superscript,
.footnote.superscript > .label,
.footnote.superscript > .backrefs {
  vertical-align: super;
  font-size: smaller;
  line-height: 1;
}
a[role="doc-noteref"].superscript > .fn-bracket,
.footnote.superscript > .label > .fn-bracket {
  /* hide brackets in display but leave for copy/paste */
  display: inline-block;
  width: 0;
  overflow: hidden;
}
[role="doc-noteref"].superscript + [role="doc-noteref"].superscript {
  padding-left: 0.15em; /* separate consecutive footnote references */
  /* TODO: unfortunately, "+" also selects with text between the references. */
}

/* Alignment */
.align-left   {
  text-align: left;
  margin-right: auto;
}
.align-center {
  text-align: center;
  margin-left: auto;
  margin-right: auto;
}
.align-right  {
  text-align: right;
  margin-left: auto;
}
.align-top    { vertical-align: top; }
.align-middle { vertical-align: middle; }
.align-bottom { vertical-align: bottom; }

/* reset inner alignment in figures and tables */
figure.align-left, figure.align-right,
table.align-left, table.align-center, table.align-right {
  text-align: inherit;
}

/* Text Blocks */
.topic { margin: 1em 2em; }
.sidebar,
.admonition,
.system-message {
  margin: 1em 2em;
  border: thin solid;
  padding: 0.5em 1em;
}
div.line-block { display: block; }
div.line-block div.line-block, pre { margin-left: 2em; }

/* Code line numbers: don't copy with drag-and-drop */
pre.code .ln { display: none; }
pre.code code:before {
  content: attr(data-lineno);
  font-size: small;
  color: gray;
}

/* Tables */
table {
  border-collapse: collapse;
}
td, th {
  border: thin solid silver;
  padding: 0 1ex;
}
.borderless td, .borderless th {
  border: 0;
  padding: 0;
  padding-right: 0.5em /* separate table cells */
}

table > caption, figcaption {
  text-align: left;
  margin-top: 0.2em;
  margin-bottom: 0.2em;
}
table.captionbelow {
  caption-side: bottom;
}

/* MathML (see "math.css" for --math-output=HTML) */
math .boldsymbol { font-weight: bold; }
math.boxed, math .boxed {padding: 0.25em; border: thin solid; }
/* style table similar to AMS "align" or "aligned" environment: */
mtable.cases > mtr > mtd { text-align: left; }
mtable.ams-align > mtr > mtd { padding-left: 0; padding-right: 0; }
mtable.ams-align > mtr > mtd:nth-child(2n) { text-align: left; }
mtable.ams-align > mtr > mtd:nth-child(2n+1) { text-align: right; }
mtable.ams-align > mtr > mtd:nth-child(2n+3) { padding-left: 2em; }
.mathscr mi, mi.mathscr {
  font-family: STIX, XITSMathJax_Script, rsfs10,
               "Asana Math", Garamond, cursive;
}

/* Document Header and Footer */
header { border-bottom: 1px solid black; }
footer { border-top: 1px solid black; }

/* Images are block-level by default in Docutils */
/* New HTML5 block elements: set display for older browsers */
img, svg, header, footer, main, aside, nav, section, figure, video, details {
  display: block;
}
svg { width: auto; height: auto; }  /* enable scaling of SVG images */
/* inline images */

p img, p svg, p video,
h1 img, h2 img, h3 img, h4 img, h5 img, h6 img,
h1 svg, h2 svg, h3 svg, h4 svg, h5 svg, h6 svg {
  display: inline;
}

</style>
<style type="text/css">

/* CSS31_ style sheet for the output of Docutils HTML writers.             */
/* Rules for easy reading and pre-defined style variants.                  */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: plain.css 10079 2025-04-10 12:01:48Z milde $                                                               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */
/* .. _CSS3: https://www.w3.org/Style/CSS/                                 */


/* Document Structure */
/* ****************** */

/* "page layout" */
body {
  margin: 0;
  background-color: #dbdbdb;
  --field-indent: 9em; /* default indent of fields in field lists */
}
main, footer, header {
  line-height:1.6;
  /* avoid long lines --> better reading */
  /* optimum is 45…75 characters/line <http://webtypography.net/2.1.2> */
  /* OTOH: lines should not be too short because of missing hyphenation, */
  max-width: 50rem;
  padding: 1px 2%; /* 1px on top avoids grey bar above title (mozilla) */
  margin: auto;
}
main {
  counter-reset: table figure;
  background-color: white;
}
footer, header {
  font-size: smaller;
  padding: 0.5em 2%;
  border: none;
}

/* Table of Contents */
ul.auto-toc > li > p {
  padding-left: 1em;
  text-indent: -1em;
}
nav.contents ul {
  padding-left: 1em;
}
main > nav.contents ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B29\ ';
}
main > nav.contents ul ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B1D\ ';
}

/* Transitions */
hr.docutils {
  width: 80%;
  margin-top: 1em;
  margin-bottom: 1em;
  clear: both;
}

/* Paragraphs */

/* vertical space (parskip) */
p, ol, ul, dl, li,
.footnote, .citation,
div > math,
table {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

h1, h2, h3, h4, h5, h6,
dd, details > p:last-child {
  margin-bottom: 0.5em;
}

/* Lists */
/* ===== */

/* Definition Lists */
/* Indent lists nested in definition lists */
dd > ul:only-child, dd > ol:only-child { padding-left: 1em; }

/* Description Lists */
/* styled like in most dictionaries, encyclopedias etc. */
dl.description {
  display: flow-root;
}
dl.description > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.3em;
}
dl.description > dd:after {
  display: table;
  content: "";
  clear: left; /* clearfix for empty descriptions */
}

/* Field Lists */

dl.field-list > dd,
dl.docinfo > dd {
  margin-left: var(--field-indent); /* adapted in media queries or HTML */
}

/* example for custom field-name width */
dl.field-list.narrow > dd {
  --field-indent: 5em;
}
/* run-in: start field-body on same line after long field names */
dl.field-list.run-in > dd p {
  display: block;
}

/* Bibliographic Fields */

/* generally, bibliographic fields use dl.docinfo */
/* but dedication and abstract are placed into divs */
div.abstract p.topic-title {
  text-align: center;
}
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic;
}
div.dedication p.topic-title {
  font-style: normal;
}

/* disclosures */
details { padding-left: 1em; }
summary { margin-left: -1em; }

/* Text Blocks */
/* =========== */

/* Literal Blocks */
pre.literal-block, pre.doctest-block,
pre.math, pre.code {
  font-family: monospace;
}

/* Block Quotes and Topics */
bockquote { margin: 1em 2em; }
blockquote p.attribution {
  text-align: right;
  margin-left: 20%;
}

/* Tables */
/* ====== */

/* th { vertical-align: bottom; } */

table tr { text-align: left; }

/* "booktabs" style (no vertical lines) */
table.booktabs {
  border: 0;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.booktabs * {
  border: 0;
}
table.booktabs th {
  border-bottom: thin solid;
}

/* numbered tables (counter defined in div.document) */
table.numbered > caption:before {
  counter-increment: table;
  content: "Table " counter(table) ": ";
  font-weight: bold;
}

/* Explicit Markup Blocks */
/* ====================== */

/* Footnotes and Citations */
/* ----------------------- */

/* line on the left */
.footnote-list {
  border-left: solid thin;
  padding-left: 0.25em;
}

/* Directives */
/* ---------- */

/* Body Elements */
/* ~~~~~~~~~~~~~ */

/* Images and Figures */

/* let content flow to the side of aligned images and figures */
figure.align-left,
img.align-left,
svg.align-left,
video.align-left,
div.align-left,
object.align-left {
  clear: left;
  float: left;
  margin-right: 1em;
}
figure.align-right,
img.align-right,
svg.align-right,
video.align-right,
div.align-right,
object.align-right {
  clear: right;
  float: right;
  margin-left: 1em;
}
/* Stop floating sidebars, images and figures */
h1, h2, h3, h4, footer, header { clear: both; }

/* Numbered figures */
figure.numbered > figcaption > p:before {
  counter-increment: figure;
  content: "Figure " counter(figure) ": ";
  font-weight: bold;
}

/* Admonitions and System Messages */
.caution p.admonition-title,
.attention p.admonition-title,
.danger p.admonition-title,
.error p.admonition-title,
.warning p.admonition-title,
div.error {
  color: red;
}

/* Sidebar */
/* Move right. In a layout with fixed margins, */
/* it can be moved into the margin.            */
aside.sidebar {
  width: 30%;
  max-width: 26em;
  float: right;
  clear: right;
  margin-left: 1em;
  margin-right: -1%;
  background-color: #fffffa;
}


/* Code */
pre.code { padding: 0.7ex }
pre.code, code { background-color: #eeeeee }
/* basic highlighting: for a complete scheme, see */
/* https://docutils.sourceforge.io/sandbox/stylesheets/ */
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}


/* Epigraph           */
/* Highlights         */
/* Pull-Quote         */
/* Compound Paragraph */
/* Container          */

/* Inline Markup */
/* ============= */

sup, sub { line-height: 0.8; } /* do not add leading for lines with sup/sub */

/* Inline Literals                                          */
/* possible values: normal, nowrap, pre, pre-wrap, pre-line */
/*   span.docutils.literal { white-space: pre-wrap; }       */

/* Hyperlink References */
a { text-decoration: none; }

/* External Targets       */
/*   span.target.external */
/* Internal Targets       */
/*   span.target.internal */
/* Footnote References    */
/*   a[role="doc-noteref"] */
/* Citation References    */
/*   a.citation-reference */

</style>
</head>
<body class="with-toc">
<main id="database-test-7-dbt-7-user-s-guide">
<h1 class="title">Database Test 7 (DBT-7) User's Guide</h1>

<nav class="contents" id="table-of-contents" role="doc-toc">
<p class="topic-title"><a class="reference internal" href="#top">Table of Contents</a></p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="toc-entry-1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#installing-dbt-7" id="toc-entry-2">Installing DBT-7</a></p>
<ul>
<li><p><a class="reference internal" href="#required-software" id="toc-entry-3">Required Software</a></p>
<ul>
<li><p><a class="reference internal" href="#supported-database-systems" id="toc-entry-4">Supported Database Systems</a></p></li>
<li><p><a class="reference internal" href="#optional-software" id="toc-entry-5">Optional Software</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#user-s-guide" id="toc-entry-6">User's Guide</a></p>
<ul>
<li><p><a class="reference internal" href="#building-tpc-ds-tools" id="toc-entry-7">Building TPC-DS Tools</a></p>
<ul>
<li><p><a class="reference internal" href="#quick-start" id="toc-entry-8">Quick Start</a></p></li>
<li><p><a class="reference internal" href="#reports" id="toc-entry-9">Reports</a></p></li>
<li><p><a class="reference internal" href="#advanced-usage" id="toc-entry-10">Advanced Usage</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#database-management-system-specific-notes" id="toc-entry-11">Database Management System Specific Notes</a></p>
<ul>
<li><p><a class="reference internal" href="#postgresql" id="toc-entry-12">PostgreSQL</a></p>
<ul>
<li><p><a class="reference internal" href="#advanced-postgresql-usage" id="toc-entry-13">Advanced PostgreSQL Usage</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#developer-s-guide" id="toc-entry-14">Developer's Guide</a></p>
<ul>
<li><p><a class="reference internal" href="#creating-custom-query-templates" id="toc-entry-15">Creating Custom Query Templates</a></p></li>
<li><p><a class="reference internal" href="#testing-individual-queries" id="toc-entry-16">Testing Individual Queries</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#toc-entry-1" role="doc-backlink">Introduction</a></h2>
<p>This document provides instructions on how to set up and use the Database Test
7 (DBT-7) kit.  This kit provides what is needed to execute a workload similar
to the TPC-DS workload.</p>
<p>This workload is composed of two phases: a load test and a performance test.
Both tests needs to be run together to constitute a complete test run.  A
<em>Queries per Hour</em> score is calculated at the end of a complete test that is
calculated from the results of both the load and performance test.</p>
<p>The performance test is composed of several additional tests: a power test, two
data maintenance test, and two throughput tests.</p>
</section>
<section id="installing-dbt-7">
<h2><a class="toc-backref" href="#toc-entry-2" role="doc-backlink">Installing DBT-7</a></h2>
<p>The latest stable and development version of the kit can be found on GitHub:
<a class="reference external" href="https://github.com/osdldbt/dbt7">https://github.com/osdldbt/dbt7</a></p>
<p>The TPC's TPC-DS Tools cannot be redistributed with DBT-7 and must be downloaded
by the tester:
<a class="reference external" href="https://www.tpc.org/tpc_documents_current_versions/current_specifications5.asp">https://www.tpc.org/tpc_documents_current_versions/current_specifications5.asp</a></p>
<section id="required-software">
<h3><a class="toc-backref" href="#toc-entry-3" role="doc-backlink">Required Software</a></h3>
<p>In addition to the database management system software, the following is also
required:</p>
<ul class="simple">
<li><p>gcc</p></li>
<li><p>SQLite <a class="reference external" href="https://www.sqlite.org/index.html">https://www.sqlite.org/index.html</a></p></li>
<li><p>lex</p></li>
<li><p>make</p></li>
<li><p>patch</p></li>
<li><p>yacc</p></li>
</ul>
<section id="supported-database-systems">
<h4><a class="toc-backref" href="#toc-entry-4" role="doc-backlink">Supported Database Systems</a></h4>
<p>These are the currently supported database systems:</p>
<ul class="simple">
<li><p>Greenplum</p></li>
<li><p>PostgreSQL</p></li>
</ul>
</section>
<section id="optional-software">
<h4><a class="toc-backref" href="#toc-entry-5" role="doc-backlink">Optional Software</a></h4>
<ul class="simple">
<li><p>Docutils - <strong>rst2html5</strong> is used to generate HTML from the reStructuredText
reports.</p></li>
<li><p><strong>sar</strong>, <strong>pidstat</strong> - Used for collecting system and per process statistics.</p></li>
<li><p>gnuplot - Used for generating plots for the HTML report.</p></li>
<li><p>pandoc - Used only to generated PDF files from the HTML reports.</p></li>
</ul>
</section>
</section>
</section>
<section id="user-s-guide">
<h2><a class="toc-backref" href="#toc-entry-6" role="doc-backlink">User's Guide</a></h2>
<section id="building-tpc-ds-tools">
<h3><a class="toc-backref" href="#toc-entry-7" role="doc-backlink">Building TPC-DS Tools</a></h3>
<p>DBT-7 provides the script <cite>dbt7-build-dsgen</cite> to apply patches and compile the
TPC-DS Tools.  The patches that are applied are minor code changes and query
templates to make the TPC-DS Tools work with the databases supposed by DBT-7.
These patches are in the <cite>patches</cite> subdirectory.</p>
<p>For example, to build the TPC-DS Tools, unzip the TPC-DS Tools zip file and run
<cite>dbt7-build-dbgen</cite> against the resulting directory:</p>
<pre class="literal-block">unzip *-tpc-ds-tool.zip
dbt7-build-dsgen DSGen-software-code-4.0.0_final</pre>
<p>For brevity, future references to the location of the TPC-DS tools will be
<cite>$DSHOME</cite>.</p>
<section id="quick-start">
<h4><a class="toc-backref" href="#toc-entry-8" role="doc-backlink">Quick Start</a></h4>
<p>Once the TPC-DS Tools is built, only one command needs to be issued to run a
complete test:</p>
<pre class="literal-block">dbt7-run --tpchtools=$DSHOME pgsql /tmp/results</pre>
<p>This will run the generate the data files for a 1 GB scale factor database
load, power and throughput test, with 2 streams, against PostgreSQL and save
the results of the test in <cite>/tmp/results</cite>.</p>
<p>If all phases of the test complete successfully, the <em>Queries per Hour</em> score
will be shown when the test completes.</p>
</section>
<section id="reports">
<h4><a class="toc-backref" href="#toc-entry-9" role="doc-backlink">Reports</a></h4>
<p>The <em>dbt7-run</em> script will generate a <em>summary.rst</em> text file can be reviewed
for the execution times for each of the tests, query times for each of the
queries in the power test, and the aggregates of the query times from the
throughput test streams.</p>
<p>If system and database stats are collected, the <em>dbt7-report</em> script can be run</p>
</section>
<section id="advanced-usage">
<h4><a class="toc-backref" href="#toc-entry-10" role="doc-backlink">Advanced Usage</a></h4>
<p>The <em>dbt7-run</em> script can be used to run any combination of a Load Test, Power
Test, and Throughput Test combined with the Data Maintenance Test.  But be
aware that a Load Test must be run in order to create the database before a
Power or Throughput Tests can be run individually.</p>
</section>
</section>
</section>
<section id="database-management-system-specific-notes">
<h2><a class="toc-backref" href="#toc-entry-11" role="doc-backlink">Database Management System Specific Notes</a></h2>
<section id="postgresql">
<h3><a class="toc-backref" href="#toc-entry-12" role="doc-backlink">PostgreSQL</a></h3>
<p>There are additional dialects for PostgreSQL that are provided to collect query
plans and <cite>EXPLAIN ANALYZE</cite> output, as shown in the examples below.  The
<cite>DBT7DMPREFIX</cite> environment variable must be used to inject SQL into the data
maintenance such that <cite>EXPLAIN</cite> output can be captures in those specific tests.
Otherwise only the 99 queries will have <cite>EXPLAIN</cite> output.</p>
<p>Run a 1GB test (with <cite>DBT7DMPREFIX</cite> unset):</p>
<pre class="literal-block">dbt7-run --tpcdstools=$DSHOME psql /tmp/results</pre>
<p>Run a 1GB test and capture <cite>EXPLAIN</cite> output query results:</p>
<pre class="literal-block">export DBT7DMPREFIX=&quot;LOAD 'auto_explain'; SET auto_explain.log_min_duration TO 0; SET auto_explain.log_level TO notice;&quot;
dbt7-run --tpcdstools=$DSHOME -d pgsqle pgsql /tmp/results</pre>
<p>Run a 1GB test and capture <cite>EXPLAIN ANALYZE</cite> output query:</p>
<pre class="literal-block">export DBT7DMPREFIX=&quot;LOAD 'auto_explain'; SET auto_explain.log_min_duration TO 0; SET auto_explain.log_analyze TO on; SET auto_explain.log_buffers TO on; SET auto_explain.log_verbose TO on; SET auto_explain.log_level TO notice;&quot;
dbt7-run --tpcdstools=$DSHOME -d pgsqlea pgsql /tmp/results</pre>
<section id="advanced-postgresql-usage">
<h4><a class="toc-backref" href="#toc-entry-13" role="doc-backlink">Advanced PostgreSQL Usage</a></h4>
<p>See <cite>examples/dbt7_pgsql_profile</cite> for the environment variables to set when not
using the <cite>dbt7-run</cite> script, in other words, tips for advanced users.</p>
<p>One example of advanced usage, requiring more user setup and configuration, is
to run this against a PostgreSQL database on a remote system.</p>
<p>Since this kit provides scripts that are potentially destructive, it relies on
some special purpose environment variables to be set in order to help prevent
damage to a database that the user may be connecting to by default.</p>
</section>
</section>
</section>
<section id="developer-s-guide">
<h2><a class="toc-backref" href="#toc-entry-14" role="doc-backlink">Developer's Guide</a></h2>
<section id="creating-custom-query-templates">
<h3><a class="toc-backref" href="#toc-entry-15" role="doc-backlink">Creating Custom Query Templates</a></h3>
<p>The TPC-DS Tools contain the official set of query templates in the
<cite>query_templates</cite> subdirectory.  Adding support for additional databases for
use in DBT-7 requires up to 3 steps:</p>
<ol class="arabic simple">
<li><p>Create a list of the 99 query templates to be executed, e.g.
<cite>templates-pgsql.tpl</cite></p></li>
<li><p>Create new query template file for any modification needed from the official
templates.  e.g. Copy <cite>query23.tpl</cite> to <cite>query23postgresql.tpl</cite>.  It is
important to keep the query number in the filename for proper recording and
analysis with the DBT-7 kit.</p></li>
<li><p>Create a new dialect file that contains proper syntax for transaction
control statements, and limit handling.  e.g. <cite>pgsql.tpl</cite></p></li>
</ol>
</section>
<section id="testing-individual-queries">
<h3><a class="toc-backref" href="#toc-entry-16" role="doc-backlink">Testing Individual Queries</a></h3>
<p>Running the individual parts of the benchmark, i.e. the Power Test of the
Throughput Test, much less the entire benchmark, don't lend it itself to making
it easy to evaluate individual query performance.  There may be times when the
developer wants to focus on an individual query to evaluate the effects of a
different index, or database system parameters.</p>
<p>The <em>run-query</em> script is intended to allow a developer to generate and execute
1 query at a time.</p>
<p>A database needs to be created first, but only needs to be loaded once if
testing individual queries.  This can be done with the run script using the
<cite>--load</cite> flag.  A PostgreSQL example:</p>
<pre class="literal-block">dbt7 run --tpchtools=$DSHOME --load pgsql load-results</pre>
<p>Then any query can be tested.  For example running Query 4:</p>
<pre class="literal-block">dbt7 run-query --tpchtools=$DSHOME 55 pgsql</pre>
<p>Here is an example of the output query output, the results, and the execution
time:</p>
<pre class="literal-block">select  i_brand_id brand_id, i_brand brand,
         sum(ss_ext_sales_price) ext_price
 from date_dim, store_sales, item
 where d_date_sk = ss_sold_date_sk
         and ss_item_sk = i_item_sk
         and i_manager_id=36
         and d_moy=12
         and d_year=2001
 group by i_brand, i_brand_id
 order by ext_price desc, i_brand_id
limit 100 ;
 brand_id |                       brand                        |     ext_price
----------+----------------------------------------------------+--------------------
  3002002 | importoexporti #2                                  |           94269.68
...

(68 rows)

Query 55 executed in 0.155 second(s).</pre>
<p>Additional flags can be used to capture system statistics (<cite>--stats</cite>), software
profiles (<cite>--profile</cite>), or explain plans (<cite>--explain</cite>).</p>
</section>
</section>
</main>
</body>
</html>
